<tool id="workflow_conditional" name="workflow select" version="0.1.0" python_template_version="3.5">
    <requirements>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        yaml=() &&
        i=0 &&
        #for $item in $yaml:
            cp $item "\$i.yaml" &&
            yaml+=("\$i.yaml") &&
            i=\$((i+1)) &&
        #end for
        echo \${yaml[$calculator]} > selected_path.yaml &&
        cp \${yaml[$calculator]} selected_config.yaml
    ]]></command>
    <inputs>
        <param type="data" multiple="true" name="yaml" format="txt" />
        <param type="select" name="calculator" value="1" help="calculator to generate structure files for. Must be a single word or a comma seperated list of values. Currently supported calculators are CASTEP, DFTB+ and UEP. Can also pass all as an option to generate files for all calculators.">
            <option value="1">uep</option>
            <option value="2">castep</option>
            <option value="3">dftb</option>
            <option value="0">all</option>
        </param>
    </inputs>
    <outputs>
        <data label="selected_path" name="out_pth" format="txt" from_work_dir="selected_path.yaml"/>
        <data label="selected_config" name="out_conf" format="txt" from_work_dir="selected_config.yaml"/>
    </outputs>
    <tests>
        <test>
            <param name="yaml" value="clusters.txt" ftype='txt'/>
            <param name="calculator" value="all"/>
            <output name="out_conf" file="clusters.txt" ftype="txt" compare="sim_size" delta_frac="0.01"/>
        </test>
    </tests>
    <help><![CDATA[
        usage: pm-muairss [-h] [-t {r,w}] structures parameter_file

        Given an input structure, generates a set of structures with a muon added in a random location.
    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{github,
  author = {Muon Spectroscopy Computational Project},
  year = {2021},
  title = {pymuon-suite},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/muon-spectroscopy-computational-project/pymuon-suite/},
}</citation>
    </citations>
</tool>
